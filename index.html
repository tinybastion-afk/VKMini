<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ú–æ–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è</title>
  <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    .vk-blue { color: #0077ff; }
  </style>
</head>
<body class="bg-zinc-100 min-h-screen">

  <div class="max-w-md mx-auto bg-white min-h-screen shadow-xl overflow-hidden">
    
    <div id="header" class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 flex items-center gap-4">
      <img id="userPhoto" class="w-16 h-16 rounded-2xl border-2 border-white object-cover" alt="–§–æ—Ç–æ">
      <div>
        <h1 class="text-2xl font-bold" id="userName">–ü—Ä–∏–≤–µ—Ç!</h1>
        <p class="text-blue-100 text-sm">–ó–∞–ø–æ–ª–Ω–∏ –∞–Ω–∫–µ—Ç—É –∑–∞ 30 —Å–µ–∫—É–Ω–¥</p>
      </div>
    </div>

    <div class="p-6">
      <form id="form" class="space-y-8">

        <div class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-zinc-700 mb-1">–ì–æ—Ä–æ–¥</label>
            <input type="text" id="city" placeholder="–ú–æ—Å–∫–≤–∞" 
                   class="w-full px-4 py-3 border border-zinc-300 rounded-2xl focus:outline-none focus:border-blue-500 text-base">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-zinc-700 mb-1">Telegram (–∏–ª–∏ –ª—é–±–æ–π –∫–æ–Ω—Ç–∞–∫—Ç)</label>
            <input type="text" id="tg" placeholder="@username" 
                   class="w-full px-4 py-3 border border-zinc-300 rounded-2xl focus:outline-none focus:border-blue-500 text-base">
          </div>

          <div>
            <label class="block text-sm font-medium text-zinc-700 mb-1">–û —Å–µ–±–µ</label>
            <textarea id="about" rows="3" placeholder="–†–∞—Å—Å–∫–∞–∂–∏ –Ω–µ–º–Ω–æ–≥–æ –æ —Å–µ–±–µ..."
                      class="w-full px-4 py-3 border border-zinc-300 rounded-3xl focus:outline-none focus:border-blue-500 text-base resize-none"></textarea>
          </div>
        </div>

        <div class="flex items-start gap-3 bg-amber-50 p-4 rounded-3xl">
          <input type="checkbox" id="adult" required class="mt-1 w-5 h-5 accent-blue-600">
          <label for="adult" class="text-sm text-zinc-700">
            –ú–Ω–µ –∏—Å–ø–æ–ª–Ω–∏–ª–æ—Å—å <span class="font-semibold">18 –ª–µ—Ç</span>.<br>
            <span class="text-xs text-zinc-500">–≠—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ</span>
          </label>
        </div>

        <div>
          <p class="text-sm font-medium text-zinc-700 mb-3">–ú–æ–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è (—Å—Ç–∞–≤—å –ª—é–±—ã–µ –≥–∞–ª–æ—á–∫–∏)</p>
          <div id="preferences" class="grid grid-cols-2 gap-3 text-sm"></div>
        </div>

        <button type="submit" 
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 rounded-3xl text-lg transition-all active:scale-95">
          –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∫–µ—Ç—É
        </button>
      </form>
    </div>
  </div>

  <div id="successModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center">
    <div class="bg-white rounded-3xl p-8 max-w-xs w-full text-center">
      <div class="text-6xl mb-4">üéâ</div>
      <h2 class="text-2xl font-bold mb-2">–°–ø–∞—Å–∏–±–æ!</h2>
      <p class="text-zinc-600 mb-6">–¢–≤–æ—è –∞–Ω–∫–µ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –ú—ã —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ–º—Å—è ‚ù§Ô∏è</p>
      <button onclick="location.reload()" 
              class="w-full bg-zinc-900 text-white py-4 rounded-3xl font-medium">
        –ó–∞–∫—Ä—ã—Ç—å
      </button>
    </div>
  </div>

  <script>
    const preferencesList = [
      "–ú—É–∑—ã–∫–∞", "–ö–∏–Ω–æ –∏ —Å–µ—Ä–∏–∞–ª—ã", "–°–ø–æ—Ä—Ç", "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è",
      "–ö—É–ª–∏–Ω–∞—Ä–∏—è", "–ö–Ω–∏–≥–∏", "–í–∏–¥–µ–æ–∏–≥—Ä—ã", "–ò—Å–∫—É—Å—Å—Ç–≤–æ",
      "–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è", "–¢–∞–Ω—Ü—ã", "–ê–≤—Ç–æ", "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"
    ];

    const prefContainer = document.getElementById('preferences');
    preferencesList.forEach(item => {
      const div = document.createElement('div');
      div.className = "flex items-center gap-2";
      div.innerHTML = `
        <input type="checkbox" id="pref-${item}" value="${item}" class="w-5 h-5 accent-blue-600">
        <label for="pref-${item}" class="text-zinc-700">${item}</label>
      `;
      prefContainer.appendChild(div);
    });

    async function initApp() {
      try {
        await vkBridge.send('VKWebAppInit');
        const user = await vkBridge.send('VKWebAppGetUserInfo');
        document.getElementById('userName').textContent = `${user.first_name} ${user.last_name}`;
        if (user.photo_200) document.getElementById('userPhoto').src = user.photo_200;
      } catch (e) { console.error(e); }
    }

    document.getElementById('form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const selectedPrefs = Array.from(document.querySelectorAll('#preferences input:checked')).map(cb => cb.value);
      const data = {
        vk_id: (await vkBridge.send('VKWebAppGetUserInfo')).id,
        city: document.getElementById('city').value.trim(),
        tg: document.getElementById('tg').value.trim(),
        about: document.getElementById('about').value.trim(),
        adult: document.getElementById('adult').checked,
        preferences: selectedPrefs
      };
      console.log('üì§ –î–∞–Ω–Ω—ã–µ:', data);
      document.getElementById('successModal').classList.remove('hidden');
    });

    window.onload = initApp;
  </script>
</body>
</html>
